<!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p>{{ site.description }}</p>
  </div>
  <div class="sidebar-avatar">
    <!-- <img src="{{ site.author.avatar }}" alt="avatar" onerror="this.style.display='none'"> -->
    <img src="{{ site.url }}/public/images/moon-round.png" alt="avatar" onerror="this.style.display='none'">
  </div>

  
    {% comment %}
    The code below dynamically generates a sidebar nav of pages with
    `layout: page` in the front-matter. See readme for usage.
    {% endcomment %}
    
    {% assign pages_list = site.pages | sort:"url" %}
    {% for node in pages_list %}
    {% if node.title != null %}
    {% if node.layout == "page" %}
    <a class="sidebar-nav-item{% if page.url == node.url %} active{% endif %}" href="{{ node.url | absolute_url }}">{{ node.title }}</a>
    {% endif %}
    {% endif %}
    {% endfor %}
    <nav class="sidebar-nav">
      <a class="sidebar-nav-item{% if page.title == 'Home' %} active{% endif %}" href="{{ '/' | absolute_url }}">Home</a>
  
    <!-- 아래는 Chirpy의 categories에서 발취  -->
    <div class="sidebar-nav-item site-category">
      Blog
      
      {% assign HEAD_PREFIX = "h_" %}
      {% assign LIST_PREFIX = "l_" %}

      {% assign group_index = 0 %}

      {% assign sort_categories = site.categories | sort %}

      {% for category in sort_categories %}
        {% assign category_name = category | first %}
        {% assign posts_of_category = category | last %}
        {% assign first_post = posts_of_category | first %}

        {% if category_name == first_post.categories[0] %}
          {% assign sub_categories = "" | split: "" %}

          {% for post in posts_of_category %}
            {% assign second_category = post.categories[1] %}
            {% if second_category %}
              {% unless sub_categories contains second_category %}
                {% assign sub_categories = sub_categories | push: second_category %}
              {% endunless %}
            {% endif %}
          {% endfor %}

          {% assign sub_categories = sub_categories | sort %}
          {% assign sub_categories_size = sub_categories | size %}

        <div class="card categories">
          <!-- top-category -->
          <div class="card-header d-flex justify-content-between hide-border-bottom"
              id="{{ HEAD_PREFIX }}{{ group_index }}">
            <span>
            {% if sub_categories_size > 0 %}
              <i class="far fa-folder-open fa-fw"></i>
            {% else %}
              <i class="far fa-folder fa-fw"></i>
            {% endif %}
              <!-- <a href="{{ site.baseurl }}/{{ category_name | slugify | url_encode }}/" -->
              <a href="{{ site.baseurl }}/{{ category_name }}/"
                class="ml-1 mr-2">
                {{ category_name }}
              </a>

              <!-- content count -->
              {% assign top_posts_size = site.categories[category_name] | size %}
              <span class="text-muted small font-weight-light">
                {% if sub_categories_size > 0 %}
                  {{ sub_categories_size }}
                  {% if sub_categories_size > 1 %}categories{% else %}category{% endif %},
                {% endif %}
                  {{ top_posts_size }}
                  post{% if top_posts_size > 1 %}s{% endif %}
              </span>
            </span>

            <!-- arrow -->
            {% if sub_categories_size > 0%}
            <a href="#{{ LIST_PREFIX }}{{ group_index }}" data-toggle="collapse"
              aria-expanded="true" aria-label="{{ HEAD_PREFIX }}{{ group_index }}-trigger"
              class="category-trigger hide-border-bottom">
              <i class="fas fa-fw fa-angle-down"></i>
            </a>
            {% else %}
            <span data-toggle="collapse" class="category-trigger hide-border-bottom disabled">
              <i class="fas fa-fw fa-angle-right"></i>
            </span>
            {% endif %}

          </div> <!-- .card-header -->

          <!-- Sub-categories -->
          {% if sub_categories_size > 0 %}
          <div id="{{ LIST_PREFIX }}{{ group_index }}" class="collapse show" aria-expanded="true">
            <ul class="list-group">
              {% for sub_category in sub_categories %}
              <li class="list-group-item" style="list-style: none;">
                <i class="far fa-folder fa-fw"></i>
                <!-- <a href="{{ site.baseurl }}/{{ category_name }}/{{ sub_category | slugify | url_encode }}/" -->
                <a href="{{ site.baseurl }}/{{ category_name }}/{{ sub_category }}/"
                  class="ml-1 mr-2">{{ sub_category }}</a>
                {% assign posts_size = site.categories[sub_category] | size %}
                <span class="text-muted small font-weight-light">{{ posts_size }}
                  post{% if posts_size > 1 %}s{% endif %}
                </span>
              </li>
              {% endfor %}
            </ul>
          </div>
          {% endif %}

        </div> <!-- .card -->

          {% assign group_index = group_index | plus: 1 %}

        {% endif %}
      {% endfor %}

    </div>
    <!-- <a class="sidebar-nav-item" href="{{ site.github.repo }}/archive/v{{ site.version }}.zip">Blog</a> -->
    <!-- <a class="sidebar-nav-item" href="{{ site.github.repo }}">GitHub project</a> -->
    <!-- <span class="sidebar-nav-item">Currently v{{ site.version }}</span> -->
  </nav>

  <div class="sidebar-item-footer">
    <p>
      &copy; {{ site.time | date: '%Y' }}. All rights reserved.
    </p>
  </div>
</div>
